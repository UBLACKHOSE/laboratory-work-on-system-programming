Многие места не обьяснены в коде, но там в основном просто обрезание текста